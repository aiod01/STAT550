---
title: "Data Pre-processing"
author: "Zhen Liu"
date: "2018/2/1"
output: html_document
---

```{r data input}
library(haven)
Rawdata<- read_sav("~/Desktop/stat450/seniorworkers/senior worker/Data/Data-NFEHRS_revised.sav")  #1247
```

### 1. Check Response
```{r response skil_num}
summary(Rawdata$num_use)
nrow(Rawdata[Rawdata$num_use==7,])  ##why there is a '7'....????
```
The max of num_use is 5 so I guessed 7 may be a wrong input. After delete this observation(num_use=7):
```{r responses qqplot }
newdata<- Rawdata[Rawdata$num_use!=7,]  #1246
par(mfrow=c(2,2))
#1)skill_num
summary(newdata$num_use)
qqnorm(newdata$num_use)
qqline(newdata$num_use)

#2) skill_lit
summary(newdata$liter_use)
qqnorm(newdata$liter_use)
qqline(newdata$liter_use)

#3) test_num
summary(newdata$pvnumM)
qqnorm(newdata$pvnumM)
qqline(newdata$pvnumM)

#4) test_lit
summary(newdata$pvlitM)
qqnorm(newdata$pvlitM)
qqline(newdata$pvlitM)

```

The top left and top right Q-Q plot are not on a straight line. We might need some further transformation on the responses(num_use, liter_use)
 
The bottom left and bottom right Q-Q plot seem on a straight line so it is fair to say that the two responses(pvnumM, pvlitM) of our sample are normal distributed. The assumption of linear regression is statisfied.


### 2. Missing Value
```{r results= 'hide'}
nrow(newdata[is.na(newdata$Mgr),]) #501
nrow(newdata[is.na(newdata$GENDER_R),]) #0
nrow(newdata[is.na(newdata$ED_Level),]) #0
nrow(newdata[is.na(newdata$EMPloyed),]) #0
nrow(newdata[is.na(newdata$Full_part),]) #0
nrow(newdata[is.na(newdata$Years_wk),]) #0
nrow(newdata[is.na(newdata$pub_priv),]) #39
nrow(newdata[is.na(newdata$NFE12),]) #0
nrow(newdata[is.na(newdata$FNFAET12),]) #0
nrow(newdata[is.na(newdata$FNFE12JR),]) #0
nrow(newdata[is.na(newdata$FNFAET12JR),]) #0
nrow(newdata[is.na(newdata$FNFAET12NJR),]) #0
nrow(newdata[is.na(newdata$NFEHRS),]) #0
```
There are 501 missing value in the 'Mgr' column, which is more than 40% of the total number of the observations. I would suggest that progressing our regression analysis without this variable first. 

There are 39 missing value in the 'pub_priv'. 
```{r pub_priv}
table(newdata$pub_priv)
```
From the table above, 1062 of the observations are from private sector while 145 of them are from Public sector.

I'll create a dataset called 'data_priv', which only contains the employees in private sector.
```{r only priv}
newdata$pub_priv <- factor(newdata$pub_priv)
data_priv <- newdata[newdata$pub_priv ==1 & (!is.na(newdata$pub_priv)), ] #1062
```

I'll create a dataset called 'data_both', which contains the employees in private sector or in public sector(that is, deleting the rows who have missing value).
```{r}
data_both <- newdata[!is.na(newdata$pub_priv), ] #1207
```







